---
title: Windows å¢åŠ å¤šä¸ªå¯ç”¨SSHå…¬é’¥
date: 2020-02-23 23:40:46
update:
categories:
tags:
- [SSH]
- [Coding]
- [Windows]
---

ä¹‹å‰ç”±äºä½¿ç”¨Github Pagesä½œä¸ºåšå®¢åœ°å€å¯¼è‡´å›½å†…è®¿é—®é€Ÿåº¦è¿‡æ…¢ï¼Œå¢åŠ äº†è…¾è®¯äº‘CDNä¾æ—§æœ‰å¤§é‡æ•°æ®ç¼“å­˜å¤±è´¥ï¼Œæ‰€ä»¥æ›´æ¢äº†å›½å†…Codingä½œä¸ºåšå®¢é•œåƒï¼ˆä¹‹å‰ç”¨è¿‡Gitee Pagesï¼Œä½†æ˜¯æ™®é€šç”¨æˆ·æ— æ³•è‡ªå®šä¹‰åŸŸåï¼‰ï¼Œåœ¨Hexoå¢åŠ Codingä»“åº“é…ç½®æ—¶ï¼Œæ— æ³•è¯†åˆ«æ–°å¢çš„SSHå…¬é’¥ï¼Œæ˜¾ç¤º `Permission denied (publickey)`, çœ‹äº†ä¸€ä¸‹Codingçš„å®˜æ–¹è®ºå›ï¼Œä»–ä»¬æ ¹æœ¬æ²¡æœ‰è§£å†³åŠæ³•ğŸ˜‚ï¼Œä»¥ä¸‹ä¸ºå‡ºç°é—®é¢˜çš„è¿‡ç¨‹ä»¥åŠæ‰¾åˆ°çš„è§£å†³åŠæ³•ã€‚

# 1. æ–°å¢å…¬é’¥

æƒ³è¦é€šè¿‡SSHè®¿é—®Codingï¼Œéœ€è¦å…ˆæ–°å¢ä¸€ä¸ªå…¬é’¥ï¼ŒåŒæ—¶åœ¨Codingç«¯å¢åŠ å…¬é’¥é…ç½®

```bash
ssh-agent -t rsa -C "your.email@example.com"

# Creates a new ssh key, using the provided email as a label
# Generating public/private rsa key pair.
Enter file in which to save the key (/Users/you/.ssh/id_rsa): [Press enter]  // æ¨èä½¿ç”¨é»˜è®¤åœ°å€ï¼Œå¦‚æœä»¥å‰çš„æœ‰ç”¨ï¼Œå°±æ”¹ä¸ºæ–°çš„åå­—ä¾‹å¦‚ id_ras_Coding_email@example.com è¿™ä¸ªæ–‡ä»¶è·¯å¾„åé¢ä¼šç”¨åˆ°
Enter passphrase (empty for no passphrase):   //æ­¤å¤„ç‚¹å‡» Enter é”®å³å¯ï¼Œä¹Ÿå¯ä»¥å¡«å†™å¯†ç ï¼Œå¡«å†™å¯†ç åæ¯æ¬¡ä½¿ç”¨ SSH æ–¹å¼æ¨é€ä»£ç æ—¶éƒ½ä¼šè¦æ±‚è¾“å…¥å¯†ç ï¼Œç”±äºè¿™ä¸ª Key ä¹Ÿä¸æ˜¯ç”¨äºå†›äº‹ç›®çš„ï¼Œæ‰€ä»¥ä¹Ÿæ— éœ€è®¾ç½®å¯†ç ã€‚
```

ç„¶åå°†ç”Ÿæˆçš„`.pub`å…¬é’¥æ·»åŠ åˆ°Codingçš„å…¬é’¥é…ç½®ä¸­ï¼Œä½¿ç”¨å‘½ä»¤æµ‹è¯•è¿æ¥æ˜¯å¦æˆåŠŸ

```bash
ssh -T git@e.coding.net
```

è¾“å…¥ `yes` å…è®¸æ–°å¢hostï¼Œå¦‚æœæ˜¾ç¤ºå·²ç»é€šè¿‡åˆ™æ­£å¸¸ï¼Œä½†æ˜¯æˆ‘åœ¨éªŒè¯è¿‡ç¨‹ä¸­ä¾æ—§æ˜¾ç¤º

```bash
Permission denied (publickey)
```

# 2. å‘ç°è§£å†³é—®é¢˜çš„æ–¹æ³•

é¦–å…ˆè§£é‡Šä¸€ä¸‹ç›¸å…³åè¯

## SSH

å…¨ç§° Secure Shell ï¼Œä¸€ä¸ªå…è®¸ä¸¤å°ç”µè„‘ä¹‹é—´é€šè¿‡å®‰å…¨çš„è¿æ¥è¿›è¡Œæ•°æ®äº¤æ¢çš„ç½‘ç»œåè®®ï¼Œé€šè¿‡åŠ å¯†åšçˆ±æŒ£äº†æ•°æ®åº“çš„ä¿å¯†æ€§å’Œå®Œæ•´æ€§ã€‚SSHé‡‡ç”¨å…¬é’¥åŠ å¯†æŠ€æœ¯æ¥éªŒè¯è¿œç¨‹ä¸»æœºï¼Œä»¥åŠå…è®¸è¿œç¨‹ä¸»æœºéªŒè¯ç”¨æˆ·ã€‚

## ssh-keygen

ç”¨äºä¸ºSSHç”Ÿæˆã€ç®¡ç†å’Œè½¬æ¢è®¤è¯å¯†é’¥ï¼Œæ”¯æŒRSAå’ŒDSAä¸¤ç§è®¤è¯å¯†é’¥ï¼Œç”Ÿæˆå¯†é’¥å°±æ˜¯ä½¿ç”¨çš„æ­¤å‘½ä»¤ã€‚

## ssh-agent

ä¸€ç§ç”¨äºä¿å­˜å…¬é’¥èº«ä»½éªŒè¯æ‰€ä½¿ç”¨çš„ç§é’¥çš„ç¨‹åºï¼Œå¦‚æœç§é’¥äº¤ç»™ssh-agentä¿ç®¡ï¼Œå…¶å®ƒç¨‹åºéœ€è¦éªŒè¯èº«ä»½çš„æ—¶å€™å¯ä»¥å°†éªŒè¯ç”³è¯·äº¤ç»™ssh-agentæ¥å®Œæˆæ•´ä¸ªè®¤è¯è¿‡ç¨‹ã€‚

---

åŒæ—¶ssh-agentä¹Ÿå¯èƒ½å¸¦æ¥é—®é¢˜ï¼Œåœ¨Windowsä¸‹å°è¯•ä½¿ç”¨SSHè¿›è¡Œèº«ä»½éªŒè¯æ—¶å°±å¯èƒ½å‡ºç°`Permission denied (publickey)` çš„é—®é¢˜ï¼Œ**ä¸»è¦å¯èƒ½çš„åŸå› å°±æ˜¯å…¬é’¥æœªåŠ è½½åˆ°ssh-agentä¸­**ï¼Œ`ssh-add -l`å¯ä»¥æŸ¥çœ‹ç›¸åº”çš„ssh keyæ˜¯å¦è¢«åŠ è½½ï¼Œè¿™å°±åˆ°äº†ä¸‹ä¸€ä¸ªé—®é¢˜ï¼Œssh-addå‘½ä»¤æ— æ³•ä½¿ç”¨ã€‚

# 3. å‘ç°ssh-addæ— æ³•ä½¿ç”¨

è¾“å…¥å‘½ä»¤

```sh
ssh-add -l
```

å°±å‡ºç°äº† ` Error connecting to agent: No such file or directory` çš„é—®é¢˜ã€‚

è¿™æ˜¯ç”±äºWindowsä¸‹çš„æœåŠ¡**OpenSSH Authentication Agent** æœªå¯åŠ¨çš„åŸå› ï¼Œ

1. Windowsä¸‹é”®å…¥ WIN+R è¾“å…¥ services.msc
2. æ‰¾åˆ°**OpenSSH Authentication Agent**æœåŠ¡ï¼Œå°†å¯åŠ¨ç±»å‹ä¿®æ”¹ä¸º **è‡ªåŠ¨** ï¼ŒåŒæ—¶å¯åŠ¨æ­¤æœåŠ¡ã€‚

æ­¤æ—¶ `ssh-add `å‘½ä»¤å°±èƒ½å¤Ÿä½¿ç”¨äº†ã€‚

# 4. å°†Codingçš„ssh keyæ·»åŠ åˆ°ssh-agentä¸‹

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ·»åŠ ssh keyåˆ°ssh-agentä¸‹

```bash
ssh-add /Users/you/.ssh/id_ras_Coding_email@example.com  # è¿™å°±æ˜¯ä¸Šé¢ç”Ÿæˆssh keyæ—¶å†™çš„åœ°å€
```

æ­¤æ—¶å†é€šè¿‡ `ssh-add -l` æŸ¥çœ‹ssh-agentä¸­ç®¡ç†çš„ssh keyå°±æœ‰äº†æ–°å¢çš„keyã€‚

# 5. æµ‹è¯•Coding

```bash
ssh -T git@e.coding.net
```

æ­¤æ—¶å°±èƒ½éªŒè¯æˆåŠŸäº†

```bash
Warning: Permanently added 'e.coding.net,(RSA) to the list of known hosts.
Coding æç¤º: Hello Frank, You've connected to Coding.net via SSH. This is a personal key.
Frankï¼Œä½ å¥½ï¼Œä½ å·²ç»é€šè¿‡ SSH åè®®è®¤è¯ Coding.net æœåŠ¡ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸ªäººå…¬é’¥.
```
